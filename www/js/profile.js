$('#btn-addNote').click(function() {
  var title = $("#inputTitle").val();
  var message = $("#InputMessage").val();
  var username = localStorage.getItem('username');
  
  if(title == "" || message == "") return;

  var formData = "username=" + username + "&" + "title=" + title + "&" + "message=" + message;
  
	$.ajax({
		type: "POST",
		url: "http://web.ist.utl.pt/ist170038/addNote.php",
		data: formData,
		success: function(data) {
			if(data.status == 'success'){
				alert("New note added!");
			}else if(data.status == 'fileExists'){
				alert("File already exists. Please chose another title.");
			}
		},
		 error:function(x,e){
            if(x.status==0){
                alert('You are offline!!\n Please Check Your Network.');
            }else if(x.status==404){
                alert('Requested URL not found.');
            }else if(x.status==500){
                alert('Internel Server Error.');
            }else if(e=='parsererror'){
                alert('Error.\nParsing JSON Request failed.');
            }else if(e=='timeout'){
                alert('Request Time out.');
            }else {
                alert('Unknow Error.\n'+x.responseText);
            }
        }
	});
});


$('#btn-search').click(function() {
  var title = $("#searchInput").val();
  var username = localStorage.getItem('username');
  
  if(title == "") return;

  var formData = "username=" + username + "&" + "title=" + title;
  
	$.ajax({
		type: "POST",
		url: "http://web.ist.utl.pt/ist170038/getNote.php",
		data: formData,
		success: function(data) {
			if(data.status == 'success'){
				alert("Note loaded!");
				  $("#inputTitle").val(title);
				$("#InputMessage").val(data.content);
			}else if(data.status == 'noFile'){
				alert("Note not found.");
			}
		},
		 error:function(x,e){
            if(x.status==0){
                alert('You are offline!!\n Please Check Your Network.');
            }else if(x.status==404){
                alert('Requested URL not found.');
            }else if(x.status==500){
                alert('Internel Server Error.');
            }else if(e=='parsererror'){
                alert('Error.\nParsing JSON Request failed.');
            }else if(e=='timeout'){
                alert('Request Time out.');
            }else {
                alert('Unknow Error.\n'+x.responseText);
            }
        }
	});
});