<?php
header("Access-Control-Allow-Origin: *");
header('Content-type: application/json');

$host="db.ist.utl.pt";	// o MySQL esta disponivel nesta maquina
$user="ist170038";	// -> substituir pelo nome de utilizador
$password="xnoe2920";	// -> substituir pela password dada pelo mysql_reset
$dbname = $user;	// a BD tem nome identico ao utilizador

$connection = new PDO("mysql:host=" . $host. ";dbname=" . $dbname, $user, $password, array(PDO::ATTR_ERRMODE => PDO::ERRMODE_WARNING));

$username=$_POST['username'];
$pass=$_POST['pass']; 

//how to hack: joao_el_terror" -- 

$login = 'SELECT * FROM Users WHERE username = "' .$username. '" AND pass = "' .$pass. '";';

$result = $connection->query($login);

$user_id = $result->fetchColumn();

/*** if we have no result then fail boat ***/
if($user_id == false)
{
		$response_array['status'] = 'error';
}
else {
		//again same story.. nothing works with fetch
		$result = $connection->query($login);
		foreach($result as $row){
			$response_array['username'] = $row['username'];
			$response_array['email'] = $row['email'];
			$response_array['name'] = $row['name'];
			$response_array['pass'] = $row['pass'];
			break;
		}
		
		
		$response_array['status'] = 'success'; 
}
$connection = null;
json_encode($response_array);
echo json_encode($response_array);
?>

